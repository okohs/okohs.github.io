!function(s){function t(s,t){this.canvas=s,this.ds=t,this.fusens={}}function i(s,t,i,e,o){var n=this;this.id=i,this.ds=t,this.pos={x:0,y:0},this.canvas=s,"mobile"==fusen_util.getDevice()?this.canvas.append('<div id="'+this.id+'" class="p-husen theme-husen--'+o+'"><img src="http://www.paper-glasses.com/api/twipi/'+fusen_util.htmlEscape(e)+'"></div>'):this.canvas.append('<div id="'+this.id+'" class="p-husen theme-husen--'+o+'"><img src="http://www.paper-glasses.com/api/twipi/'+fusen_util.htmlEscape(e)+'" alt="profile image" width="55" height="55"><div class="p-husen__cross">×</div></div>');var p=$(".p-husen__cross","#"+this.id);if($("#"+this.id).draggable({start:function(){},drag:function(){n.pos.x=$("#"+n.id).position().left,n.pos.y=$("#"+n.id).position().top},stop:function(){n.ds.set(n.id,{x:n.pos.x,y:n.pos.y}),n.setPos(n.pos.x,n.pos.y)}}),p.click(function(s){n.ds.set(n.id,{deleted:!0}),s.stopPropagation()}),"mobile"==fusen_util.getDevice()){var d=720;$("#"+n.id).bind("touchstart",function(s){function t(){clearTimeout(timer)}timer=setTimeout(function(){confirm("このメッセージを削除しますか？")===!0&&n.ds.set(n.id,{deleted:!0})},d),$("#"+n.id).bind("touchend touchmove touchcancel",t),s.stopPropagation()})}}t.prototype.getFusen=function(s){return this.fusens[s]},t.prototype.createFusen=function(s,t,e){var o=new i(this.canvas,this.ds,s,t,e);return this.fusens[s]=o,o},i.prototype.setPos=function(s,t){var i=0,e=127.6,o=this;o.pos.x=s+i,o.pos.y=t+e,$("#"+this.id).offset({top:o.pos.y,left:o.pos.x}),o.pos.y+$("#"+o.id).height()>o.canvas.height()&&o.canvas.css("height",o.pos.y+$("#"+o.id).outerHeight()+"px"),o.pos.x+$("#"+o.id).width()>o.canvas.width()&&(o.canvas.css("width",o.pos.x+$("#"+o.id).outerWidth()+"px"),$("#header").css("width",o.pos.x+$("#"+o.id).outerWidth()+"px"))},i.prototype.removeSelf=function(){var s=this;$("#"+s.id).remove()},s.FusenBuilder=t,s.Fusen=i}(window);